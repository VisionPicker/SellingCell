webpackJsonp([1],{"0iig":function(t,e){},I1c4:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("7+uW"),a=s("//Fk"),i=s.n(a),n={created:function(){this.loginInfo=this.$localstore.fetch()},mounted:function(){},data:function(){return{activeIndex:"index",loginInfo:{},error_show:!1,recommendation:[{name:"算法导论",title:"你也许看不懂，但是你需要",id:3,img:"./static/image/title.jpg"}],dialogVisible:!1,login_params:{name:"",password:""},error_text:""}},watch:{dialogVisible:function(t){0==this.dialogVisible&&(this.login_params.name=null,this.login_params.password=null)},login_params:{handler:function(t,e){this.error_show=!1},deep:!0},loginInfo:{handler:function(t){console.log("loginInfo出现变化"),this.$store.commit("setUser",this.loginInfo),this.$localstore.save(this.loginInfo)},deep:!0}},methods:{openLoginDialog:function(){this.dialogVisible=!0},handleClose:function(t){},login:function(){var t=this;if(console.log("用户名:"+this.login_params.name),console.log("密码:"+this.login_params.password),!this.checkName(this.login_params.name)||!this.checkPassword(this.login_params.password))return this.error_text="用户名或密码输入格式错误",void(this.error_show=!0);var e=this.$md5(this.login_params.password);this.$api.post("login",{username:this.login_params.name,password:e},function(e){console.log("登录成功"),console.log("用户名:"+e.data.username),console.log("角色"+e.data.role),t.dialogVisible=!1,t.loginInfo.authorization=!0,t.loginInfo.role=e.data.role,t.loginInfo.userid=e.data.userid,t.loginInfo.username=e.data.username,t.$store.commit("setUser",t.loginInfo),t.$localstore.save(t.loginInfo),t.error_show=!1},function(e){t.error_text="用户名或密码错误",t.error_show=!0})},logout:function(){var t=this;console.log("注销"),this.$api.post("/user/logout",null,function(e){t.$store.commit("clearUser"),t.$localstore.clear(),t.$router.push("/")},function(e){t.$store.commit("clearUser"),t.$localstore.clear(),t.$router.push("/")})},checkName:function(t){return new RegExp(/^[a-zA-Z0-9_]{4,16}$/).test(t)},checkPassword:function(t){return new RegExp(/^[a-zA-Z0-9_]{4,20}$/).test(t)},handleSelect:function(t,e){switch(console.log("导航栏选择: "+t),t){case"index":this.$router.push("/allgoods");break;case"orders":this.$router.push("/orders");break;case"puton":this.$router.push("/goods/puton");break;case"logout":this.logout();break;case"login":this.openLoginDialog();break;case"cart":this.$router.push("/shoppingcart")}},showCart:function(){console.log("展示购物车")}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"block"},[[s("el-carousel",{attrs:{interval:3e3,arrow:"always",height:"200px"}},t._l(t.recommendation,function(t){return s("el-carousel-item",{key:t.id},[s("img",{attrs:{src:t.img,width:"1500",height:"200"}})])}))]],2),t._v(" "),s("el-menu",{attrs:{"default-active":"index",mode:"horizontal","background-color":"#303133","text-color":"#909399","active-text-color":"#C0C4CC"},on:{select:t.handleSelect}},[s("el-menu-item",{attrs:{index:"index"}},[s("i",{staticClass:"el-icon-tickets"}),t._v("商品浏览")]),t._v(" "),this.$store.state.authorization&&"customer"==this.$store.state.role?s("el-menu-item",{attrs:{index:"cart"}},[s("i",{staticClass:"el-icon-goods"}),t._v("购物车\n    ")]):t._e(),t._v(" "),this.$store.state.authorization&&"customer"==this.$store.state.role?s("el-submenu",{attrs:{index:"customer_account"}},[s("template",{slot:"title"},[t._v("账号[ "+t._s(this.$store.state.username)+" ]")]),t._v(" "),s("el-menu-item",{attrs:{index:"orders"}},[t._v("订单")]),t._v(" "),s("el-menu-item",{attrs:{index:"logout"}},[t._v("注销")])],2):t._e(),t._v(" "),this.$store.state.authorization&&"seller"==this.$store.state.role?s("el-menu-item",{attrs:{index:"puton"}},[s("i",{staticClass:"el-icon-circle-plus-outline"}),t._v("发布商品\n    ")]):t._e(),t._v(" "),this.$store.state.authorization&&"seller"==this.$store.state.role?s("el-submenu",{attrs:{index:"seller_account"}},[s("template",{slot:"title"},[t._v("账号[ "+t._s(this.$store.state.username)+" ]")]),t._v(" "),s("el-menu-item",{attrs:{index:"logout"}},[t._v("\n          注销\n        ")])],2):t._e(),t._v(" "),this.$store.state.authorization?t._e():s("el-menu-item",{attrs:{index:"login"}},[t._v("登录")])],1),t._v(" "),s("el-dialog",{attrs:{title:"登录",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-input",{attrs:{placeholder:"用户名"},model:{value:t.login_params.name,callback:function(e){t.$set(t.login_params,"name",e)},expression:"login_params.name"}}),t._v(" "),s("span",[t._v(" ")]),t._v(" "),s("el-input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.login_params.password,callback:function(e){t.$set(t.login_params,"password",e)},expression:"login_params.password"}}),t._v(" "),t.error_show?s("el-alert",{attrs:{title:t.error_text,type:"error",closable:!1,center:!0,"show-icon":""}}):t._e(),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r={name:"App",components:{Nav:s("VU/8")(n,l,!1,function(t){s("TlXL")},null,null).exports},data:function(){return{}},created:function(){var t=this;this.$api.setResponseInterceptor(function(e){return console.log("intercept response"),e.data.success||1!=e.data.code||(t.$store.commit("clearUser"),t.$localstore.clear(),t.$message({message:"尚未登录或登录超时，请重新登录",type:"error"}),t.$router.push("/")),e.data.success||2!=e.data.code||t.$message({message:"没有访问权限",type:"error"}),console.log(e.data.success),e},function(t){return i.a.reject(t)})},methods:{}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"root-layer",attrs:{id:"app"}},[e("Nav"),this._v(" "),e("div",{staticClass:"line"}),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var u=s("VU/8")(r,c,!1,function(t){s("Y98e")},null,null).exports,d=s("/ocq"),g={data:function(){return{goodslist:[],options:[{value:"not_purchased",label:"未购买"},{value:"all",label:"全部商品"}],value:"all",role:this.$store.state.role}},created:function(){},mounted:function(){this.getAllGoods()},computed:{getRole:function(){return this.$store.state.role},getUser:function(){return this.$store.state.userid}},watch:{value:function(t){switch(t){case"all":this.getAllGoods();break;case"not_purchased":this.getNotPurchasedGoods()}console.log("选择了"+this.value)},getRole:function(t){this.role=t},getUser:function(){console.log("登录角色变化，重新加载数据"),this.getAllGoods()}},methods:{getAllGoods:function(){var t=this;this.$api.get("goods/info/all",null,function(e){t.goodslist=e.data},null)},getNotPurchasedGoods:function(){var t=this;this.$api.get("/user/customer/goods/list/not_purchased",null,function(e){t.goodslist=e.data},null)},getPurchasedGoods:function(){var t=this;this.$api.get("/user/customer/goods/list/purchased",null,function(e){t.goodslist=e.data},null)},putoff:function(t){var e=this;console.log(t),this.$confirm("确定删除选中当前商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$api.delete("user/seller/goods/putoff/"+t,null,function(t){e.$message({type:"success",message:"删除商品成功!"}),console.log("删除成功"),e.getAllGoods()},null)}).catch(function(){e.$message({type:"success",message:"取消删除商品!"})})}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",["customer"==t.role?s("el-select",{attrs:{placeholder:"全部商品"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})):t._e(),t._v(" "),s("div",{staticClass:"clear"}),t._v(" "),t._l(t.goodslist,function(e){return s("div",{key:e.goodsid,staticClass:"goodsplat"},[s("div",{staticClass:"goodsplat-img"},[s("img",{attrs:{src:e.img,width:"270",height:"270",float:"left",onerror:"this.src='static/image/default.jpg'"}})]),t._v(" "),s("div",[s("div",{staticClass:"list-price"},[t._v("￥"+t._s(e.price))]),t._v(" "),"seller"==t.role?s("div",{staticClass:"list-sold"},[0==e.sold_quantity?s("el-button",{staticClass:"putoff_button",attrs:{icon:"el-icon-delete",size:"small"},on:{click:function(s){t.putoff(e.goodsid,e.title)}}},[t._v("下架")]):s("span",{staticClass:"list_sold_quantity"},[t._v("已售"+t._s(e.sold_quantity)+"件")])],1):t._e(),t._v(" "),"customer"==t.role&&e.purchased?s("div",{staticClass:"list-sold"},[s("span",{staticClass:"el-icon-success purchased"},[t._v("已购买")])]):t._e(),t._v(" "),s("div",{staticClass:"clear"}),t._v(" "),s("div",{staticClass:"list-title"},[s("router-link",{attrs:{to:{name:"show",params:{id:e.goodsid}}}},[t._v(t._s(e.title.slice(0,54)))])],1)])])})],2)},staticRenderFns:[]};var h=s("VU/8")(g,p,!1,function(t){s("ej9f")},null,null).exports,m={data:function(){return{goods:{goodsid:1,title:"标题",price:0,introduction:"无 ",detail:"无 ",img:"",sold_quantity:0,purchased:!1},quantity:1}},mounted:function(){console.log("good detail"),this.getGoodsDetail()},watch:{$route:function(){"show"==this.$route.name&&this.getGoodsDetail()}},methods:{getGoodsDetail:function(){var t=this;this.$api.get("goods/info/"+this.$route.params.id,null,function(e){t.goods=e.data},function(e){4==e.code&&t.$message({message:"此商品不存在或者已经下架!",type:"error"}),t.$router.push("/")})},goBack:function(){this.$router.push("/")},addtoCart:function(t){var e=this;console.log("加入购物车:"+t),t>0&&this.$api.post("/user/customer/shoppingcart/add",{goodsid:this.goods.goodsid,quantity:t},function(t){e.$message({message:"已加入购物车",type:"success"})},null)},edit:function(){console.log("编辑商品信息"),this.$router.push("/goods/modify/"+this.goods.goodsid)},putoff:function(){var t=this;console.log(this.goods.goodsid),this.$confirm("确定删除当前商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$api.delete("user/seller/goods/putoff/"+t.goods.goodsid,null,function(e){t.$message({type:"success",message:"删除商品成功!"})},null),t.$router.push("/")}).catch(function(){t.$message({type:"success",message:"取消删除商品!"})})}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",[s("el-col",{attrs:{span:2}},[s("div",{staticClass:"nav"})]),t._v(" "),s("el-col",{attrs:{span:20}},[s("div",{staticClass:"nav bg-purple-light"},[s("el-button",{attrs:{plain:!0,icon:"el-icon-back",border:"0px"},on:{click:t.goBack}},[t._v("返回首页")])],1)]),t._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"nav"})])],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:2}},[s("div",{staticClass:"grid-content"})]),t._v(" "),s("el-col",{staticClass:"grid-content",attrs:{span:7}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("div",{attrs:{height:"400",width:"400"}},[s("img",{attrs:{src:t.goods.img,height:"400",width:"400",onerror:"this.src='static/image/default.jpg'"}})])])]),t._v(" "),s("el-col",{staticClass:"grid-content bg-purple-light",attrs:{span:13}},[s("div",{staticClass:"title"},[s("h3",["customer"==this.$store.state.role&&this.goods.purchased?s("i",{staticClass:"el-icon-success purchased_label"},[t._v("[已购买]  ")]):t._e(),t._v(" "+t._s(t.goods.title))])]),t._v(" "),s("div",{staticClass:"abstract"},[s("h3",[t._v("[摘要]")]),t._v(" "),s("p",{attrs:{"word-break:break-all":""}},[t._v(" "+t._s(t.goods.introduction)+"\r\n            ")])]),t._v(" "),s("div",[s("span",{staticClass:"show-price"},[t._v("￥ "+t._s(t.goods.price))]),s("span",{staticClass:"show-sold_quantity"},[t._v("      已出售: "+t._s(t.goods.sold_quantity)+" 件 ")]),s("br"),s("br")]),t._v(" "),this.$store.state.authorization&&"customer"==this.$store.state.role?s("div",[s("el-input-number",{attrs:{min:1,max:999,label:"quantity"},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}}),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addtoCart(t.quantity)}}},[t._v("加入购物车")])],1):t._e(),t._v(" "),this.$store.state.authorization&&"seller"==this.$store.state.role&&0==t.goods.quantity?s("el-button",{attrs:{icon:"el-icon-delete"},on:{click:t.putoff}},[t._v("删除商品")]):t._e(),t._v(" "),this.$store.state.authorization&&"seller"==this.$store.state.role?s("el-button",{attrs:{icon:"el-icon-edit",type:"primary"},on:{click:t.edit}},[t._v("编辑商品")]):t._e()],1),t._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"grid-content "})])],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:2}},[s("div",{staticClass:"grid-content"})]),t._v(" "),s("el-col",{attrs:{span:20}},[s("div",{staticClass:"grid-content bg-purple-light"},[s("div",{staticClass:"detail"},[s("h3",[t._v("[商品详情]")]),t._v(" "),s("p",[t._v(t._s(t.goods.detail))])])])]),t._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"grid-content "})])],1)],1)},staticRenderFns:[]};var f=s("VU/8")(m,v,!1,function(t){s("UooM")},null,null).exports,_={data:function(){return{goods:{goodsid:-1,title:"",price:0,introduction:"",detail:"",img:""},showImage:"",method:"upload",not_upload:!1,netImage:""}},mounted:function(){var t=this,e=this.$route.params.id;"modify"==this.$route.name&&e&&(console.log("参数"),this.$api.get("goods/info/"+e,null,function(e){t.goods=e.data,t.showImage=e.data.img,t.method="address",t.not_upload=!0,t.netImage=e.data.img},null))},watch:{netImage:function(t){this.showImage=t,this.goods.img=t},method:function(t){"upload"==t&&(this.netImage="")}},created:function(){},methods:{handleAvatarSuccess:function(t,e){!0===t.success?(this.goods.img=t.data.image,this.showImage=URL.createObjectURL(e.raw)):1==t.code?(this.$message({message:"尚未登录或登录超时,请重新登录！",type:"error"}),this.$store.commit("clearUser"),this.$localstore.clear(),this.$router.push("/")):this.$message.error("图片上传失败！")},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,s="image/png"===t.type,o=t.size/1024/1024<1;return e||s||this.$message.error("上传图片只能是 PNG或JPG 格式!"),o||this.$message.error("上传图片大小不能超过 1MB!"),(e||s)&&o},goBack:function(){window.history.length>1?this.$router.go(-1):this.$router.push("/")},changeMethod:function(t){console.log("选择的按钮"+t),this.not_upload="upload"!=t},cancel:function(){this.goBack()},testGoodsValid:function(){return!(null==this.goods.title||this.goods.title.length<2||this.goods.introduction.length>80)&&(!(null==this.goods.introduction||this.goods.introduction.length<2||this.goods.introduction.length>140)&&(!(null==this.goods.detail||this.goods.detail.length<2||this.goods.detail.length>1e3)&&!(null==this.goods.price||this.goods.price<0||this.goods.price>1e9)))},modify:function(){var t=this;this.not_upload||(this.goods.img="/images/show/"+this.goods.img),this.testGoodsValid()?this.$api.post("user/seller/goods/modify",this.goods,function(e){console.log("修改商品成功"),t.$message({message:"修改商品成功!",type:"success"}),t.$router.push("/goods/show/"+e.data.goodsid)},null):this.$message({message:"输入的商品的信息有误，请重新检查",type:"info"})},publish:function(){var t=this;this.not_upload||(this.goods.img="/images/show/"+this.goods.img),-1==this.goods.goodsid&&this.$api.post("user/seller/goods/puton/",this.goods,function(e){console.log("发布商品成功"),t.$message({message:"发布商品成功!",type:"success"}),t.$router.push("/goods/show/"+e.data.goodsid)},function(e){1==e.code?(t.$message({message:"登录认证超时失效，请重新登录系统",type:"error"}),t.$localstore.clear(),t.$store.commit("clearUser"),t.$router.push("/")):t.$message({message:"发布商品出现错误",type:"error"})})}}},y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",[s("el-col",{attrs:{span:2}},[s("div",{staticClass:"nav"})]),t._v(" "),s("el-col",{attrs:{span:20}},[s("div",{staticClass:"nav bg-purple-light"},[s("h2",[t._v("发布商品")])])]),t._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"nav"})])],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:2}},[s("div",{staticClass:"min-height"})]),t._v(" "),s("el-col",{staticClass:"min-height bg-purple-light",attrs:{span:7}},[s("div",{staticClass:" bg-purple-light"},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"api/user/seller/images/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,disabled:t.not_upload}},[t.showImage?s("img",{staticClass:"avatar",attrs:{src:t.showImage}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t._v(" "),s("span",[t._v("点击上传商品图片，图片大小不超过1MB")])],1)]),t._v(" "),s("el-col",{staticClass:"bg-purple-light  text-content min-height",attrs:{span:13}},[s("span",{staticClass:"label"},[t._v("[标题]")]),s("br"),t._v(" "),s("div",{staticClass:"abstract_auto"},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入标题",minlength:2,maxlength:80,rows:4},model:{value:t.goods.title,callback:function(e){t.$set(t.goods,"title",e)},expression:"goods.title"}})],1),t._v(" "),s("div",{staticClass:"abstract_auto"},[s("span",{staticClass:"label"},[t._v("[摘要]")]),s("br"),t._v(" "),s("el-input",{attrs:{minlength:2,maxlength:140,rows:5,type:"textarea",placeholder:"请输入摘要"},model:{value:t.goods.introduction,callback:function(e){t.$set(t.goods,"introduction",e)},expression:"goods.introduction"}})],1),t._v(" "),s("span",{staticClass:"label"},[t._v("[商品图片]")]),s("span",[t._v("（每个商品只有一张图片，以最后选择的方式上传的图片为最新）")]),s("br"),t._v(" "),s("el-radio-group",{on:{change:t.changeMethod},model:{value:t.method,callback:function(e){t.method=e},expression:"method"}},[s("el-radio",{attrs:{label:"upload"}},[t._v("本地上传")]),t._v(" "),s("el-radio",{attrs:{label:"address"}},[t._v("图片地址")])],1),t._v(" "),s("br"),t._v(" "),"upload"==t.method?s("el-alert",{staticClass:"address",attrs:{title:"本地上传模式下，点击左侧图标上传商品图片",type:"error",closable:!1}}):t._e(),t._v(" "),s("div",["address"==t.method?s("el-input",{staticClass:"address",attrs:{minlength:2,maxlength:1e3,placeholder:"请输入网络图片地址，长度<200，如要上传本地图片请选择本地上传模式"},model:{value:t.netImage,callback:function(e){t.netImage=e},expression:"netImage"}}):t._e()],1),t._v(" "),s("span",{staticClass:"label"},[t._v("[价格]")]),s("br"),t._v(" "),s("span",{staticClass:"price"},[t._v("￥")]),t._v(" "),s("el-input",{staticClass:"number",attrs:{type:"number",min:"0"},model:{value:t.goods.price,callback:function(e){t.$set(t.goods,"price",e)},expression:"goods.price"}}),t._v(" "),s("div",{staticClass:"bg-purple-light"},[s("div",{staticClass:"abstract_auto "},[s("span",{staticClass:"label"},[t._v("[商品详情]")]),s("br"),t._v(" "),s("el-input",{attrs:{minlength:2,maxlength:1e3,rows:20,type:"textarea",placeholder:"请输入商品详情正文"},model:{value:t.goods.detail,callback:function(e){t.$set(t.goods,"detail",e)},expression:"goods.detail"}})],1)]),t._v(" "),s("br"),t._v(" "),s("el-button",{attrs:{plain:""},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),"puton"==this.$route.name?s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.publish}},[t._v("完发布成")]):t._e(),t._v(" "),"modify"==this.$route.name?s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.modify}},[t._v("完成编辑")]):t._e()],1),t._v(" "),s("el-col",{attrs:{span:2}},[s("div",{staticClass:"min-height"})])],1)],1)},staticRenderFns:[]};var b=s("VU/8")(_,y,!1,function(t){s("kD8h")},null,null).exports,w=s("RRo+"),$=s.n(w),C=s("BO1k"),k=s.n(C),x={data:function(){return{items:[],goods_quantity:{}}},created:function(){},mounted:function(){this.getShoppingcartItems()},computed:{total:function(){var t=0,e=!0,s=!1,o=void 0;try{for(var a,i=k()(this.items);!(e=(a=i.next()).done);e=!0){var n=a.value;t=n.quantity*n.price+t}}catch(t){s=!0,o=t}finally{try{!e&&i.return&&i.return()}finally{if(s)throw o}}return t.toFixed(2)}},methods:{getShoppingcartItems:function(){var t=this;this.$api.post("user/customer/shoppingcart/show",null,function(e){t.items=e.data;var s=!0,o=!1,a=void 0;try{for(var i,n=k()(t.items);!(s=(i=n.next()).done);s=!0){var l=i.value;t.$set(t.goods_quantity,l.goodsid,l.quantity)}}catch(t){o=!0,a=t}finally{try{!s&&n.return&&n.return()}finally{if(o)throw a}}},null)},changeAfter:function(t,e){console.log("商品号:"+t+" 数量："+e)},balance:function(){var t=this;this.$confirm("确定购买当前商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$api.post("user/customer/shoppingcart/balance",null,function(e){t.items=[],t.$message({message:"下单成功，快去看看吧~",type:"success"})},null)}).catch(function(){})},goBack:function(){window.history.length>1?this.$router.go(-1):this.$router.push("/")},deleteGoods:function(t){var e=this;console.log(t.goodsid),this.$confirm("确定删除选中当前商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$api.delete("user/customer/shoppingcart/remove/"+t.goodsid,null,function(t){e.$message({type:"success",message:"删除商品成功!"}),console.log("删除成功"),e.getShoppingcartItems()},null)}).catch(function(){})},handleInput:function(t){var e=this,s=String(t.goodsid),o=parseInt(this.goods_quantity[s]);!$()(o)||o>999||o<1?this.goods_quantity[s]=t.quantity:this.updateQuantity(t.goodsid,o,function(e){t.quantity=o},function(o){e.goods_quantity[s]=t.quantity})},addQuantity:function(t){var e=this,s=String(t.goodsid),o=this.goods_quantity[s];o<999&&(t.quantity=o+1,this.updateQuantity(t.goodsid,t.quantity,function(t){e.goods_quantity[s]++},function(e){t.goodsid=o}))},decreaseQuantity:function(t){var e=this,s=String(t.goodsid),o=this.goods_quantity[s];o>1&&(t.quantity=o-1,this.updateQuantity(t.goodsid,t.quantity,function(t){e.goods_quantity[s]--},function(e){t.goodsid=o}))},updateQuantity:function(t,e,s,o){var a={goodsid:t,quantity:e};this.$api.post("user/customer/shoppingcart/modify",a,s,o)}}},q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",[s("el-col",{attrs:{span:3}},[s("div",{staticClass:"nav"})]),t._v(" "),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"nav bg-purple-light"},[s("h2",[t._v("我的购物车")]),t._v(" "),s("hr"),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{"header-row-class-name":"item-header",data:t.items,"empty-text":"购物车还没有东西~"}},[s("el-table-column",{attrs:{label:"商品","min-width":"50%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"little-img"},[s("img",{attrs:{width:"200",height:"200",src:e.row.img}})]),t._v(" "),s("div",{staticClass:"simple-title"},[s("router-link",{attrs:{to:{name:"show",params:{id:e.row.goodsid}}}},[t._v(t._s(e.row.title))])],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"单价","min-width":"30%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"item-price"},[t._v("￥ "+t._s(e.row.price))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"数量","min-width":"20%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"quantity-edit"},[s("el-input",{on:{change:function(s){t.handleInput(e.row)}},model:{value:t.goods_quantity[e.row.goodsid],callback:function(s){t.$set(t.goods_quantity,e.row.goodsid,t._n(s))},expression:"goods_quantity[scope.row.goodsid]"}},[s("el-button",{attrs:{slot:"prepend"},on:{click:function(s){t.decreaseQuantity(e.row)}},slot:"prepend"},[s("i",{staticClass:"el-icon-minus"})]),t._v(" "),s("el-button",{attrs:{slot:"append"},on:{click:function(s){t.addQuantity(e.row)}},slot:"append"},[s("i",{staticClass:"el-icon-plus"})])],1)],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:" ","min-width":"10%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"quantity-edit"},[s("el-button",{attrs:{type:"text"},on:{click:function(s){t.deleteGoods(e.row)}}},[s("i",{staticClass:"el-icon-delete quantity-edit"})])],1)]}}])})],1),t._v(" "),s("div",{staticClass:"total"},[t._v("总计：￥ "+t._s(t.total))]),t._v(" "),s("div",{staticClass:"order-button"},[s("el-button",{on:{click:t.goBack}},[t._v("退出")]),t._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:t.balance}},[t._v("结算")])],1)],1)]),t._v(" "),s("el-col",{attrs:{span:3}},[s("div",{staticClass:"nav"})])],1)],1)},staticRenderFns:[]};var I=s("VU/8")(x,q,!1,function(t){s("0iig")},null,null).exports,S={data:function(){return{orders:[]}},created:function(){},mounted:function(){var t=this;this.$api.get("user/customer/orders",null,function(e){t.orders=e.data},null)},methods:{transformDate:function(t){return new Date(t).toLocaleString()}}},U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",[s("el-col",{attrs:{span:3}},[s("div",{staticClass:"nav"})]),t._v(" "),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"nav bg-purple-light"},[s("h2",[t._v("我的订单")]),t._v(" "),s("hr"),t._v(" "),t._l(t.orders,function(e){return s("div",{key:e.orderid},[s("el-table",{staticStyle:{width:"100%"},attrs:{"header-row-class-name":"orders-item-header",data:e.list,"empty-text":"还没有购买过东西，快去看看有什么好东西吧~"}},[s("el-table-column",{attrs:{label:"订单编号: "+e.orderid,"min-width":"45%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"orders-little-img"},[s("el-tooltip",{attrs:{placement:"right",content:"此页面的图片和标题都属于交易快照，点击链接进入查看实时商品信息"}},[s("img",{attrs:{width:"100",height:"100",src:e.row.img,onerror:"this.src='static/image/default.jpg'"}})])],1),t._v(" "),s("div",{staticClass:"orders-simple-title"},[s("router-link",{attrs:{to:{name:"show",params:{id:e.row.goodsid}}}},[t._v(t._s(e.row.title))])],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"orders-item-price"},[t._v("￥ "+t._s(e.row.price))])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"orders-item-price"},[s("span",[t._v(t._s(e.row.quantity))])])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:" ","min-width":"25%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"orders-item-price"},[s("span",{staticClass:"orders-item-price"},[t._v("￥"+t._s(e.row.total))])])]}}])})],1),t._v(" "),s("div",{staticClass:"orders-date"},[t._v("日期： "+t._s(t.transformDate(e.ordered_time)))]),t._v(" "),s("div",{staticClass:"orders-total"},[t._v("总计：￥ "+t._s(e.total))]),t._v(" "),s("hr")],1)})],2)]),t._v(" "),s("el-col",{attrs:{span:3}},[s("div",{staticClass:"nav"})])],1)],1)},staticRenderFns:[]};var T=s("VU/8")(S,U,!1,function(t){s("I1c4")},null,null).exports;o.default.use(d.a);var z=new d.a({routes:[{path:"/",name:"index",component:h},{path:"/allgoods",name:"allgoods",component:h},{path:"/goods/puton",component:b,name:"puton"},{path:"/goods/modify/:id",component:b,name:"modify"},{path:"/goods/show/:id",component:f,name:"show"},{path:"/shoppingcart",component:I,name:"cart"},{path:"/orders",component:T,name:"orders"}]}),R=s("mvHQ"),G=s.n(R),E="api/",B=s("mtWM");function V(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function A(t,e,s,o,a){s&&(s=function t(e){for(var s in e)null===e[s]&&delete e[s],"string"===V(e[s])?e[s]=e[s].trim():"object"===V(e[s])?e[s]=t(e[s]):"array"===V(e[s])&&(e[s]=t(e[s]));return e}(s)),B({method:t,url:e,data:"POST"==t||"PUT"==t?s:null,params:"GET"==t||"DELETE"==t?s:null,baseURL:E,withCredentials:!1}).then(function(t){1==t.data.success?o&&o(t.data):a?a(t.data):console.log("error:"+G()(t.data))}).catch(function(t){var e=t.response;t&&console.log("api error,HTTP CODE:"+e.status)})}var D={get:function(t,e,s,o){return A("GET",t,e,s,o)},post:function(t,e,s,o){return A("POST",t,e,s,o)},put:function(t,e,s,o){return A("PUT",t,e,s,o)},delete:function(t,e,s,o){return A("DELETE",t,e,s,o)},setResponseInterceptor:function(t,e){B.interceptors.response.use(t,e)}},P={fetch:function(){(new Date).valueOf();return JSON.parse(window.sessionStorage.getItem("login_store_info")||"{}")},save:function(t){(new Date).valueOf();window.sessionStorage.setItem("login_store_info",G()(t))},clear:function(){window.sessionStorage.removeItem("login_store_info")}},L=s("NYxO"),N=s("zL8q"),j=s.n(N),O=(s("tvR6"),s("NC6I")),F=s.n(O);o.default.use(j.a),o.default.use(L.a),o.default.config.productionTip=!1,o.default.prototype.$api=D,o.default.prototype.$md5=F.a,o.default.prototype.$localstore=P;var Q=new L.a.Store({state:{authorization:!1,userid:null,username:"",role:""},mutations:{setUser:function(t,e){t.authorization=e.authorization,t.userid=e.userid,t.username=e.username,t.role=e.role},clearUser:function(t){t.userid=null,t.username="",t.role="",t.authorization=!1}}});new o.default({el:"#app",router:z,store:Q,components:{App:u},template:"<App/>"})},TlXL:function(t,e){},UooM:function(t,e){},Y98e:function(t,e){},ej9f:function(t,e){},kD8h:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.b0cdeebe1fbfb1518982.js.map